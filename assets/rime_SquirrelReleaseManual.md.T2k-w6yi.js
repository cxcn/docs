import{_ as s,c as e,o as i,U as a}from"./chunks/framework.WKpLpN6N.js";const u=JSON.parse('{"title":"Squirrel Release Manual","description":"","frontmatter":{},"headers":[],"relativePath":"rime/SquirrelReleaseManual.md","filePath":"home.wiki/SquirrelReleaseManual.md"}'),l={name:"rime/SquirrelReleaseManual.md"},t=a(`<h1 id="squirrel-release-manual" tabindex="-1">Squirrel Release Manual <a class="header-anchor" href="#squirrel-release-manual" aria-label="Permalink to &quot;Squirrel Release Manual&quot;">​</a></h1><ol><li><p>Update the version of <code>squirrel/data/squirrel.yaml</code> if there are changes since last release.</p></li><li><p>Run <code>package/bump_version</code> to update app version; push the commit and version tag to GitHub.</p><p>Pushing the version tag will trigger a release CI build on GitHub Actions.</p></li><li><p>At the <a href="https://github.com/rime/squirrel/releases" target="_blank" rel="noreferrer">GitHub Releases</a> page, edit the draft release created from CI, publish it as latest release, then download the zip archive.</p></li><li><p>Copy/move the downloaded file to local source tree, under <code>squirrel/package/</code>.</p></li><li><p>Put private key file in <code>squirrel/package/sign/</code>.</p><p>The private key for signing auto-update Squirrel releases is owned by Rime Keyholder.</p></li><li><p>In <a href="https://github.com/rime/squirrel/actions" target="_blank" rel="noreferrer">GitHub Actions</a>, find the release CI workflow run with the version tag, then copy the sha256 checksum from build log, near the end of &quot;Build Squirrel&quot; step.</p><p>For example:</p><pre><code>bash package/make_archive
adding: Squirrel.pkg (deflated 0%)
sha256 checksum:
8f3f3e9aa2e923e88220ea603dcbd3b70c3a88d8177a6c487cfdccc946b25379  Squirrel-0.16.1.zip
</code></pre></li><li><p>Run</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sign-archive</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> checksum=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">f3f3e9aa2e923e88220ea603dcbd3b70c3a88d8177a6c487cfdccc946b25379</span></span></code></pre></div><p>The script generates <code>package/*appcast.xml</code>.</p></li><li><p>Prepare to update project website.</p><p>Assume GitHub repo <code>rime/&lt;project&gt;</code> is cloned to local directory <code>./&lt;project&gt;</code>; do</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> squirrel/package/appcast.xml</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> home/blog/source/release/squirrel/appcast.xml</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> squirrel/package/testing-appcast.xml</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> home/blog/source/testing/squirrel/appcast.xml</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cat</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">EOF</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> home/blog/source/release/squirrel/index.md</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">title: 【鼠鬚管】更新日誌</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">comments: false</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">$(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">date</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;+date: %Y-%m-%d %H:%M:%S&#39;)</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">---</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">EOF</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> squirrel/CHANGELOG.md</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> home/blog/source/release/squirrel/index.md</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> home/blog/source/release/squirrel/index.md</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  home/blog/source/testing/squirrel/index.md</span></span></code></pre></div></li><li><p>Also update latest Squirrel version and download URL in</p><ul><li><code>home/blog/source/_data/downloads.yaml</code></li><li><code>home/blog/source/download/index.md</code></li></ul></li><li><p>Test the website locally with Hexo:</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -g</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> hexo-cli</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> home/blog</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">hexo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> server</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">open</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> http://0.0.0.0:4000/</span></span></code></pre></div><p>Verify the updated links are valid.</p></li><li><p>Commit changes with commit message <code>chore(release): squirrel \${version} :tada:</code> and push to <a href="https://github.com/rime/home" target="_blank" rel="noreferrer"><code>rime/home</code></a>.</p><p>This will trigger automated update to the site <a href="https://rime.im" target="_blank" rel="noreferrer">https://rime.im</a>.</p></li></ol>`,2),n=[t];function p(r,h,o,d,c,k){return i(),e("div",null,n)}const F=s(l,[["render",p]]);export{u as __pageData,F as default};
